# 호이스팅(Hoisting)

## 호이스팅의 개념

함수 안에 있는 선언들을 모두 끌어올려서 해당 함수 유효 범위의 최상단에 선언하는 것을 말한다.

## 호이스팅이란

- 자바스크립트 함수는 실행되기 전에 함수 안에 필요한 변수값들을 모두 모아서 유효 범위의 최상단에 선언한다.
    - 자바스크립트 Parser가 함수 실행 전 해당 함수를 한 번 훑는다.
    - 함수 안에 존재하는 변수/함수선언에 대한 정보를 기억하고 있다가 실행시킨다.
    - 유효 범위 : 함수 블록 { } 안에서 유효
- 함수 내에서 아래쪽에 존재하는 내용 중 필요한 값들을 끌어올리는 것이다.
    - 실제로 코드가 끌어올려지는 건 아니며, 자바스크립트 Parser 내부적으로 끌어올려서 처리하는 것이다.
    - 실제 메모리에서는 변화가 없다.

### **변수 호이스팅 (var, let, const 키워드)**

- **자바스크립트의 모든 선언에는 호이스팅이 일어난다.**
- **그런데 let, const, class를 이용한 선언문을 호이스팅이 발생하지 않는 것처럼 동작한다.**
- **var 키워드로 선언된 변수와는 달리 let 키워드로 선언된 변수를 선언문 이전에 참조하면 참조 에러(ReferenceError)가 발생한다.**
- **이는 let 키워드로 선언된 변수는 스코프의 시작에서 변수의 선언까지 *일시적 사각지대(Temporal Dead Zone; TDZ)에 빠지기 때문이다.**

## 호이스팅의 대상

- var 변수 선언과 함수선언문에서만 호이스팅이 일어난다.
    - var 변수/함수의 선언만 위로 끌어 올려지면, 할당은 끌어 올려지지 않는다.
    - let/const 변수 선언과 함수표현식에서는 호이스팅이 발생하지 않는다.
- 간단한 예시 (var 변수 vs let/const 변수)

```jsx
console.log("hello");
  var myname = "HEEE"; // var 변수 
  let myname2 = "HEEE2"; // let 변수 
```

```jsx
JS Parser 내부의 호이스팅(Hoisting)의 결과
  var myname; // [Hoisting] "선언"
  console.log("hello");
  myname = "HEEE"; // "할당"
  let myname2 = "HEEE2"; // [Hoisting] 발생 X
```

### 함수 선언문

일반적인 프로그래밍 언어에서의 함수 선언과 비슷합니다.

```jsx
function 함수명(){
	구현 로직
}
```

### 함수 표형식

유연한 자바스크립트 언어의 특징을 활용한 선언 방식 - 함수를 변수화시킬 수 있다.

```jsx
const 함수명 = function(){
	구현 로직
}
```

함수 선언식은 호이스팅에 영향을 받지만, 함수표현식은 호이스팅에 영향을 받지 않습니다.

### 함수 표현식의 장점

- 함수를 변수화시킬 수 있기 때문에 함수의 객체를 쉽게 변수로 나타내어 리턴할 수 있다는 장점을 가지고 있다.
- 위의 장점을 통해 자바스크립트의 클로저, 콜백함수 구현이 쉽게 가능하다.

### 클로저

```
// 변수는 global
let variable = "global";

function func(){
    // 함수 안에 있는 변수는 local
    let variable = "local";

    const clouser = () => {
        console.log(variable);
    }

    return clouser;
}

// 내부 함수를 리턴(함수 표현식을 사용하기에 가능)
const reference = func();

// reference의 스코프는 전역임에도 불구하고 func안에 있는 변수를 출력
reference(); // 출력: local;
```

### **1단계: 선언 단계(Declaration phase)**

- **변수를 실행 컨텍스트의 변수 객체에 등록한다.이 변수 객체는 스코프가 참조하는 대상이 된다.**

### **2단계: 초기화 단계(Initialization phase)**

- **변수 객체에 등록된 변수를 위한 공간을 메모리에 확보한다.이 단계에서 변수는 undefined로 초기화 된다.**

### **3단계: 할당 단계(Assignment phase)**

- **undefined로 초기화된 변수에 실제 값을 할당한다.**